<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sdev 245 Final</title>
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
min-height: 100vh;
padding: 20px;
}

.container {
max-width: 1200px;
margin: 0 auto;
}

.header {
text-align: center;
color: white;
margin-bottom: 30px;
}

.header h1 {
font-size: 2.5em;
margin-bottom: 10px;
text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
}

.header p {
font-size: 1.1em;
opacity: 0.9;
}

.main-grid {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 20px;
margin-bottom: 20px;
}

.panel {
background: white;
border-radius: 12px;
padding: 25px;
box-shadow: 0 10px 30px rgba(0,0,0,0.2);
}

.panel h2 {
color: #333;
margin-bottom: 20px;
font-size: 1.3em;
border-bottom: 2px solid #667eea;
padding-bottom: 10px;
}

.input-group {
margin-bottom: 20px;
}

label {
display: block;
color: #555;
margin-bottom: 8px;
font-weight: 600;
}

input[type="text"],
input[type="file"],
textarea {
width: 100%;
padding: 12px;
border: 2px solid #e0e0e0;
border-radius: 6px;
font-family: 'Courier New', monospace;
font-size: 0.95em;
transition: border-color 0.3s;
}

input[type="text"]:focus,
input[type="file"]:focus,
textarea:focus {
outline: none;
border-color: #667eea;
}

textarea {
resize: vertical;
min-height: 100px;
}

.button-group {
display: flex;
gap: 10px;
flex-wrap: wrap;
}

button {
flex: 1;
padding: 12px 20px;
border: none;
border-radius: 6px;
font-size: 1em;
font-weight: 600;
cursor: pointer;
transition: all 0.3s;
min-width: 120px;
}

.btn-primary {
background: #667eea;
color: white;
}

.btn-primary:hover {
background: #5568d3;
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
}

.btn-secondary {
background: #f0f0f0;
color: #333;
}

.btn-secondary:hover {
background: #e0e0e0;
}

.checkbox-group {
display: flex;
flex-direction: column;
gap: 10px;
margin: 15px 0;
}

.checkbox-item {
display: flex;
align-items: center;
gap: 8px;
}

input[type="checkbox"] {
width: 18px;
height: 18px;
cursor: pointer;
accent-color: #667eea;
}

.results-panel {
grid-column: 1 / -1;
}

.log-output {
background: #1e1e1e;
color: #00ff00;
padding: 20px;
border-radius: 6px;
font-family: 'Courier New', monospace;
font-size: 0.9em;
max-height: 300px;
overflow-y: auto;
line-height: 1.5;
margin-bottom: 20px;
}

.log-line {
margin: 5px 0;
}

.log-info {
color: #00ff00;
}

.log-error {
color: #ff4444;
}

.log-warning {
color: #ffaa00;
}

.log-success {
color: #44ff44;
}

.findings-container {
max-height: 600px;
overflow-y: auto;
}

.finding {
background: #f5f5f5;
border-left: 4px solid #ff6b6b;
padding: 15px;
margin-bottom: 12px;
border-radius: 4px;
}

.finding.high {
border-left-color: #ff6b6b;
background: #fff5f5;
}

.finding.medium {
border-left-color: #ffa94d;
background: #fff9f0;
}

.finding.low {
border-left-color: #74b9ff;
background: #f0f9ff;
}

.finding-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 8px;
}

.finding-severity {
display: inline-block;
padding: 3px 10px;
border-radius: 4px;
font-size: 0.85em;
font-weight: 600;
}

.severity-high {
background: #ff6b6b;
color: white;
}

.severity-medium {
background: #ffa94d;
color: white;
}

.severity-low {
background: #74b9ff;
color: white;
}

.finding-file {
font-weight: 600;
color: #333;
font-family: 'Courier New', monospace;
word-break: break-all;
}

.finding-details {
font-size: 0.9em;
color: #666;
margin: 8px 0;
}

.finding-match {
background: #fff3cd;
padding: 8px;
border-radius: 3px;
font-family: 'Courier New', monospace;
font-size: 0.85em;
margin-top: 8px;
word-break: break-all;
border-left: 2px solid #ffc107;
}

.stats {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 15px;
margin-bottom: 20px;
}

.stat-box {
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
color: white;
padding: 20px;
border-radius: 8px;
text-align: center;
}

.stat-number {
font-size: 2em;
font-weight: bold;
margin-bottom: 5px;
}

.stat-label {
font-size: 0.9em;
opacity: 0.9;
}

.no-findings {
text-align: center;
padding: 40px 20px;
color: #999;
}

.sample-text {
background: #f5f5f5;
padding: 10px;
border-radius: 4px;
font-size: 0.85em;
color: #666;
margin-top: 10px;
}

@media (max-width: 768px) {
.main-grid {
grid-template-columns: 1fr;
}

.stats {
grid-template-columns: 1fr;
}

.header h1 {
font-size: 1.8em;
}
}

.loading {
display: none;
text-align: center;
color: #667eea;
margin: 20px 0;
}

.spinner {
display: inline-block;
width: 30px;
height: 30px;
border: 4px solid #f3f3f3;
border-top: 4px solid #667eea;
border-radius: 50%;
animation: spin 1s linear infinite;
}

@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}
</style>
```

</head>
<body>
<div class="container">
<div class="header">
<h1>üîê Hardcoded Secrets Scanner</h1>
<p>Detect API keys, passwords, tokens, and other sensitive data in your code</p>
</div>

```
<div class="main-grid">
<div class="panel">
<h2>üìã Input</h2>

<div class="input-group">
<label>Select File or Paste Code</label>
<input type="file" id="fileInput" accept=".js,.ts,.jsx,.tsx,.py,.java,.cpp,.c,.go,.rb,.php,.cs,.rs,.sh,.bash,.yml,.yaml,.json,.xml,.html,.css,.sql,.env,.conf,.config,.txt,.md" />
<div class="sample-text">üìÅ Select a code file to scan or paste code below</div>
</div>

<div class="input-group">
<label>Or Paste Code Directly</label>
<textarea id="codeInput" placeholder="Paste your code here..."></textarea>
</div>

<div class="input-group">
<label>File Name (for reference)</label>
<input type="text" id="fileName" placeholder="e.g., config.js, .env, secrets.py">
</div>

<div class="input-group">
<label>Secret Patterns to Check</label>
<div class="checkbox-group">
<div class="checkbox-item">
<input type="checkbox" id="checkApiKeys" checked>
<label for="checkApiKeys">API Keys (AWS, Google, Azure, etc.)</label>
</div>
<div class="checkbox-item">
<input type="checkbox" id="checkPasswords" checked>
<label for="checkPasswords">Passwords & Credentials</label>
</div>
<div class="checkbox-item">
<input type="checkbox" id="checkTokens" checked>
<label for="checkTokens">Tokens & Auth Headers</label>
</div>
<div class="checkbox-item">
<input type="checkbox" id="checkPrivateKeys" checked>
<label for="checkPrivateKeys">Private Keys (RSA, SSH, etc.)</label>
</div>
<div class="checkbox-item">
<input type="checkbox" id="checkDatabaseUrls" checked>
<label for="checkDatabaseUrls">Database URLs & Connection Strings</label>
</div>
<div class="checkbox-item">
<input type="checkbox" id="checkJwt" checked>
<label for="checkJwt">JWT Tokens</label>
</div>
</div>
</div>

<div class="button-group">
<button class="btn-primary" onclick="scanCode()">üîç Scan Code</button>
<button class="btn-secondary" onclick="clearAll()">Clear All</button>
</div>
</div>

<div class="panel">
<h2>üìä Scan Log</h2>
<div class="log-output" id="logOutput">
<div class="log-line log-info">Scanner initialized. Ready to scan...</div>
</div>
<div class="loading" id="loading">
<div class="spinner"></div>
<p>Scanning...</p>
</div>
<button class="btn-secondary" onclick="clearLog()" style="width: 100%;">Clear Log</button>
</div>

<div class="panel results-panel">
<h2>üìà Results</h2>
<div id="resultsContainer"></div>
</div>
</div>
</div>

<script>
const secretPatterns = {
apiKeys: [
{ name: 'AWS Access Key', pattern: /AKIA[0-9A-Z]{16}/, severity: 'high' },
{ name: 'AWS Secret Key', pattern: /(aws_secret_access_key|aws_access_key_id)\s*[:=]\s*[\'"]?[A-Za-z0-9\/+=]{40}[\'"]?/, severity: 'high' },
{ name: 'Google API Key', pattern: /AIza[0-9A-Za-z\-_]{35}/, severity: 'high' },
{ name: 'GitHub Token', pattern: /ghp_[0-9a-zA-Z]{36}|ghu_[0-9a-zA-Z]{36}/, severity: 'high' },
{ name: 'Stripe Key', pattern: /(sk_live_|pk_live_|sk_test_|pk_test_)[0-9a-zA-Z]{24,}/, severity: 'high' },
{ name: 'Slack Token', pattern: /xox[baprs]-\d{12}-[a-zA-Z]{32}/, severity: 'high' },
{ name: 'Discord Token', pattern: /(\d{18}|[MN][A-Za-z\d_-]{23,25})\.[\w-]{6}\.[\w-]{27}/, severity: 'high' },
],
passwords: [
{ name: 'Hardcoded Password', pattern: /(password|passwd|pwd)\s*[:=]\s*[\'"]([^\'"]{6,})[\'"]/, severity: 'high' },
{ name: 'Database Password', pattern: /(mysql_password|db_password|password|passwd)\s*[:=]\s*[\'"]([^\'"]{1,})[\'"]/, severity: 'high' },
],
tokens: [
{ name: 'Bearer Token', pattern: /(Bearer|Authorization)\s+[A-Za-z0-9\-._~+\/]+=*/, severity: 'high' },
{ name: 'API Token', pattern: /(api_key|apikey|api-key|token)\s*[:=]\s*[\'"]([a-zA-Z0-9\-_]{20,})[\'"]/, severity: 'high' },
{ name: 'OAuth Token', pattern: /oauth[_-]?token\s*[:=]\s*[\'"]([a-zA-Z0-9\-_]{20,})[\'"]/, severity: 'high' },
],
privateKeys: [
{ name: 'RSA Private Key', pattern: /-----BEGIN RSA PRIVATE KEY-----/, severity: 'high' },
{ name: 'SSH Private Key', pattern: /-----BEGIN (RSA|DSA|EC|PGP|OPENSSH) PRIVATE KEY-----/, severity: 'high' },
],
databaseUrls: [
{ name: 'Database Connection String', pattern: /(mysql|postgres|mongodb|redis|sqlite):\/\/[^\s]+/, severity: 'high' },
{ name: 'JDBC Connection String', pattern: /jdbc:[^\s]+/, severity: 'high' },
{ name: 'Database Host with Credentials', pattern: /([a-zA-Z0-9_]+):([a-zA-Z0-9_!@#$%^&*]+)@([a-zA-Z0-9.-]+)/, severity: 'high' },
],
jwt: [
{ name: 'JWT Token', pattern: /eyJhbGciOi[a-zA-Z0-9_-]*\.eyJ[a-zA-Z0-9_-]*\.[a-zA-Z0-9_-]*/, severity: 'medium' },
]
};

let logs = [];

function addLog(message, type = 'info') {
const timestamp = new Date().toLocaleTimeString();
logs.push({ message, type, timestamp });
updateLogOutput();
}

function updateLogOutput() {
const logOutput = document.getElementById('logOutput');
logOutput.innerHTML = logs.map(log =>
`<div class="log-line log-${log.type}">[${log.timestamp}] ${escapeHtml(log.message)}</div>`
).join('');
logOutput.scrollTop = logOutput.scrollHeight;
}

function escapeHtml(text) {
const map = {
'&': '&amp;',
'<': '&lt;',
'>': '&gt;',
'"': '&quot;',
"'": '&#039;'
};
return text.replace(/[&<>"']/g, m => map[m]);
}

document.getElementById('fileInput').addEventListener('change', function(e) {
const file = e.target.files[0];
if (file) {
const reader = new FileReader();
reader.onload = function(event) {
document.getElementById('codeInput').value = event.target.result;
document.getElementById('fileName').value = file.name;
addLog(`File loaded: ${file.name}`, 'success');
};
reader.onerror = function() {
addLog('Error reading file', 'error');
};
reader.readAsText(file);
}
});

function scanCode() {
const code = document.getElementById('codeInput').value;
const fileName = document.getElementById('fileName').value || 'unknown';

if (!code.trim()) {
addLog('Error: Please select a file or paste code to scan', 'error');
return;
}

document.getElementById('loading').style.display = 'block';
logs = [];
addLog(`Starting scan of "${fileName}"...`, 'info');
addLog(`Code length: ${code.length} characters`, 'info');

// Simulate async operation
setTimeout(() => {
const findings = [];
const enabledPatterns = getEnabledPatterns();

Object.entries(enabledPatterns).forEach(([category, patterns]) => {
patterns.forEach(patternObj => {
const lines = code.split('\n');
lines.forEach((line, lineIndex) => {
const matches = [...line.matchAll(new RegExp(patternObj.pattern, 'gi'))];
matches.forEach(match => {
findings.push({
file: fileName,
line: lineIndex + 1,
pattern: patternObj.name,
match: match[0],
severity: patternObj.severity,
category: category
});
addLog(`Found ${patternObj.name} at line ${lineIndex + 1}`, 'warning');
});
});
});
});

addLog(`Scan completed. Found ${findings.length} potential secrets.`, findings.length === 0 ? 'success' : 'error');
displayResults(findings);
document.getElementById('loading').style.display = 'none';
}, 500);
}

function getEnabledPatterns() {
const patterns = {};

if (document.getElementById('checkApiKeys').checked) {
patterns.apiKeys = secretPatterns.apiKeys;
}
if (document.getElementById('checkPasswords').checked) {
patterns.passwords = secretPatterns.passwords;
}
if (document.getElementById('checkTokens').checked) {
patterns.tokens = secretPatterns.tokens;
}
if (document.getElementById('checkPrivateKeys').checked) {
patterns.privateKeys = secretPatterns.privateKeys;
}
if (document.getElementById('checkDatabaseUrls').checked) {
patterns.databaseUrls = secretPatterns.databaseUrls;
}
if (document.getElementById('checkJwt').checked) {
patterns.jwt = secretPatterns.jwt;
}

return patterns;
}

function displayResults(findings) {
const container = document.getElementById('resultsContainer');

if (findings.length === 0) {
container.innerHTML = `
<div class="stats">
<div class="stat-box">
<div class="stat-number">‚úì</div>
<div class="stat-label">No Secrets Found</div>
</div>
</div>
<div class="no-findings">
<p>Great! No hardcoded secrets detected in the scanned code.</p>
</div>
`;
return;
}

const highCount = findings.filter(f => f.severity === 'high').length;
const mediumCount = findings.filter(f => f.severity === 'medium').length;
const lowCount = findings.filter(f => f.severity === 'low').length;

let html = `
<div class="stats">
<div class="stat-box">
<div class="stat-number">${findings.length}</div>
<div class="stat-label">Total Findings</div>
</div>
<div class="stat-box">
<div class="stat-number" style="color: #ff6b6b;">${highCount}</div>
<div class="stat-label">High Severity</div>
</div>
<div class="stat-box">
<div class="stat-number" style="color: #ffa94d;">${mediumCount}</div>
<div class="stat-label">Medium Severity</div>
</div>
</div>
<div class="findings-container">
`;

findings.forEach((finding, index) => {
const maskedMatch = maskSecret(finding.match);
html += `
<div class="finding ${finding.severity}">
<div class="finding-header">
<span class="finding-file">üìÑ ${escapeHtml(finding.file)}</span>
<span class="finding-severity severity-${finding.severity}">
${finding.severity.toUpperCase()}
</span>
</div>
<div class="finding-details">
<strong>Pattern:</strong> ${escapeHtml(finding.pattern)} |
<strong>Line:</strong> ${finding.line}
</div>
<div class="finding-match">
<strong>Matched:</strong> ${escapeHtml(maskedMatch)}
</div>
</div>
`;
});

html += '</div>';
container.innerHTML = html;
}

function maskSecret(secret) {
if (secret.length <= 4) return '****';
const visible = Math.floor(secret.length / 4);
return secret.substring(0, visible) + '*'.repeat(secret.length - visible);
}

function clearAll() {
document.getElementById('codeInput').value = '';
document.getElementById('fileName').value = '';
document.getElementById('fileInput').value = '';
document.getElementById('resultsContainer').innerHTML = '';
logs = [];
addLog('Cleared all inputs', 'info');
}

function clearLog() {
logs = [];
updateLogOutput();
addLog('Log cleared', 'info');
}

addLog('Scanner ready. Upload a file or paste code and click "Scan Code"', 'info');
</script>

</body>
</html>